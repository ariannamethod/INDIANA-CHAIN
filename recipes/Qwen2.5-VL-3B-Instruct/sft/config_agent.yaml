# Model arguments
# You can download the model and manually change the rope to 300k/500k and max_position_embeddings to 32768
model_name_or_path: Qwen/Qwen2.5-VL-3B-Instruct
vision_model: true
model_revision: main
torch_dtype: bfloat16
attn_implementation: sdpa

# Data training arguments
dataset_name: smolagents/aguvis-stage-2
dataset_num_proc: 48

#SFT hyperparam
max_length: 32768
weight_decay: 0.0001
optim: adamw_torch
lr_scheduler_type: linear
warmup_ratio: 0.1
learning_rate: 3.0e-05
gradient_accumulation_steps: 8
per_device_eval_batch_size: 4
per_device_train_batch_size: 4 # Change this depending on the context length of the model to keep a 500M GBS. 

single_gpu: true

# SFT trainer config
max_steps: -1
num_train_epochs: 6
bf16: true
do_eval: false
eval_strategy: 'no'
gradient_checkpointing: true
gradient_checkpointing_kwargs:
  use_reentrant: false
hub_model_id: smolagents/Qwen2.5-VL-3B-Instruct-Agentic
hub_strategy: end
push_to_hub: true
log_level: info
logging_steps: 5
logging_strategy: steps
output_dir: data/smolagents-Qwen2.5-VL-3B-Instruct-Agentic
overwrite_output_dir: true
report_to:
- wandb
save_strategy: "epoch"
save_steps: 1
save_total_limit: 1
seed: 42

dataset_mixture:
  datasets:                     # List of datasets to include in the mixture
    - id: smolagents/aguvis-stage-2  # Hub dataset ID
      config: mind2web     # Name of the dataset config
      split: train            # Split to use from the dataset
      columns:                  # Columns to keep
        - images
        - texts
      weight: 1.
    - id: smolagents/aguvis-stage-2
      config: guiact-web-single
      split: train
      columns:
        - images
        - texts
      weight: 1.
    - id: smolagents/aguvis-stage-2
      config: guiact-web-multi
      split: train
      columns:
        - images
        - texts
      weight: 1.
  seed: 42                      # Seed for shuffling the combined dataset
  test_split_size: 0.1   